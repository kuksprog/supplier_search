# Supplier Search Service

Сервис для поиска и валидации поставщиков с использованием Yandex Search API и SPARK API.

## Особенности

- Поиск компаний по категории и географическому расположению
- Обогащение данных о компаниях через SPARK API
- Валидация компаний по множеству критериев
- Веб-интерфейс на Flask
- REST API на FastAPI
- Асинхронная обработка запросов

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd supplier_search
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
# или
venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте файл `.env` в корневой директории проекта:
```bash
YANDEX_SEARCH_API_KEY=your_yandex_api_key
SPARK_API_KEY=your_spark_api_key
```

## Запуск

Запустите оба сервиса (Flask и FastAPI) одной командой:
```bash
python run.py
```

После запуска:
- Веб-интерфейс будет доступен по адресу: http://localhost:5000
- API будет доступно по адресу: http://localhost:8000

## API Endpoints

### POST /search
Поиск поставщиков по заданным критериям.

Пример запроса:
```json
{
    "category": "монтаж пожарки",
    "location": "москва"
}
```

Пример ответа:
```json
{
    "companies": {
        "company_1": {
            "inn": "1234567890",
            "legal_name": "ООО Компания",
            "website": "http://example.com",
            "email": "contact@example.com",
            "phone": "+7 (999) 123-45-67"
        }
    }
}
```

## Критерии валидации компаний

- Статус: Действующее · ЕГРЮЛ
- Размер предприятия: Средние
- Риск: Низкий
- ИФР: 0-30
- ИДО: 0-40
- ИПД: 79-100
- Выручка: от 50 млн.
- Риск ликвидации: Не обнаружено
- Риск банкротства: Не обнаружено
- Сведения о реорганизации: Не обнаружено
- Отсутствуют незавершенные исполнительные производства
- Не входит в рисковые реестры
- Наименование СРО: Строительное проектирование
- Лицензируемая деятельность: Эксплуатация взрывопожароопасных и химически опасных производственных объектов 

## Развертывание с Docker

### Требования
- Docker
- Docker Compose

### Быстрый старт

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd supplier_search
```

2. Запустите приложение с помощью Docker Compose:
```bash
docker-compose up -d
```

3. Приложение будет доступно по адресу:
```
http://localhost:5000
```

### Развертывание на Ubuntu 24.04

1. Клонируйте репозиторий на вашу Ubuntu машину:
```bash
git clone <repository-url>
cd supplier_search
```

2. Запустите скрипт развертывания:
```bash
./deploy.sh
```

3. Скрипт автоматически установит Docker и Docker Compose (если они отсутствуют) и запустит приложение.

4. После завершения приложение будет доступно по IP-адресу вашего сервера на порту 5000.

### Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта со следующим содержимым:

```bash
YANDEX_SEARCH_API_KEY=your_yandex_api_key
SPARK_API_KEY=your_spark_api_key
```

### Управление контейнером

- **Запуск**: `docker-compose up -d`
- **Остановка**: `docker-compose down`
- **Просмотр логов**: `docker-compose logs -f`
- **Перезапуск**: `docker-compose restart` 